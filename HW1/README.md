Our peak detection function uses the sliding window approach. With this approach, first, a window size is defined. The function then slides through the data, one window at a time, calculating dynamic upper and lower thresholds for each window based on percentiles. The data points within the window are evaluated to identify potential peaks based on these thresholds. 
A peak is detected if a data point is higher than its neighboring points and surpasses both the local (window-specific) and global thresholds. The algorithm also ensures that consecutive peaks are separated by a minimum distance to avoid false detections that are near each other.
After a peak is detected, the signal needs to fall below a lower threshold (both global and dynamic) before another peak can be registered. This reset mechanism helps prevent multiple peaks from being detected in noisy or fluctuating data. 
The function also includes a registration feature to reduce false positives. When a peak is detected within one window, the function doesn't immediately confirm it; instead, it waits to analyze the next window. 
If the signal continues to rise in the next window, the function determines that the previous peak was false and discards it. And it continues to search for a peak. This feature ensures only true peaks are recorded, preventing false positives by double checking upcoming trend before confirming a peak as valid.
